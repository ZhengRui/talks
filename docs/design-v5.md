# Design v5: Expressiveness Analysis — Layout Model vs Freeform Generation

## Motivation

After achieving near pixel-perfect PPTX fidelity in v4, we tested whether our YAML + layout model approach could replicate a presentation originally generated by the `frontend-slides` Claude Code skill. The test subject was a 20-slide Chinese history deck (五代十国 / Five Dynasties and Ten Kingdoms).

**Finding**: our 35 predefined templates lack the expressive power to match freeform HTML generation. This document analyzes the architectural gap and its trade-offs.

## Test: Replicating frontend-slides Output

### Setup

- **Original**: `frontend-slides/examples/five-dynasties/index.html` — 20 slides, Paper & Ink aesthetic, split-panel layout, custom decorative elements
- **Replicate**: `content/five-dynasties-replicate/slides.yaml` — same 20 slides mapped to our best-matching templates with `paper-ink` theme

### Findings

**Content fidelity**: Achievable. All text from the original can be captured in YAML, though some slides require creative template choice (e.g., using `comparison` to hold bullets + quote, or `stats` to show the 乱/变/合 closing characters).

**Visual fidelity**: Significantly lower. The original's signature visual identity cannot be expressed with our template system:

| Visual Element | Original (frontend-slides) | Our Replicate |
|---|---|---|
| Split panel (paper left / dark right) | CSS grid with different text colors per panel | `comparison` template — same bg, same text color both sides |
| Dynasty tags / badges | Custom `.dynasty-tag` elements with color variants | Not supported |
| Red seal stamps | Rotated bordered squares with single character | Not supported |
| Brush dividers | Vertical gradient lines between panels | Not supported (accent-line decorator is horizontal) |
| Ink dividers | Horizontal gradient-to-transparent lines | Partially — accent line in title block |
| Mixed content per slide | Bullets + stats, bullets + quote, timeline + stats | One template type per slide |
| Kingdom cards grid | 5×2 cards with name, dates, and founder | `icon-grid` — icon + single label only |
| Per-panel text styling | Dark panel has gold headings, light body text | All text uses same theme colors |
| Responsive typography | `clamp()` for all font sizes and spacing | Fixed px values on 1920×1080 canvas |

## Architecture Comparison

### frontend-slides: Generative Skill

The entire system is two markdown files:

```
SKILL.md           (1098 lines) — Instructions for Claude
STYLE_PRESETS.md   (527 lines)  — 12 curated style definitions
```

**Data flow:**

```
User request → Claude reads instructions → asks questions → generates 3 style previews
→ user picks style → Claude writes single self-contained HTML file from scratch
→ optionally: Claude writes bespoke generate_pptx.py script
```

There is no build step, no framework, no intermediate representation, and no runtime. Claude directly writes raw HTML/CSS/JS as a single file. Each slide is hand-composed with whatever elements the presentation needs.

**PPTX generation**: Claude writes a bespoke Python script (`python-pptx`) per presentation. The script defines custom helper functions (e.g., `add_seal()`, `add_tag()`, `add_dark_panel()`) and reproduces the HTML's visual structure using PPTX shapes.

### talks: Declarative Pipeline

```
slides.yaml → loadPresentation() → layoutPresentation() → LayoutPresentation (JSON IR)
    ├── Web:  LayoutRenderer.tsx    (React, absolute-positioned divs)
    └── PPTX: exportPptx()         (PptxGenJS + JSZip post-processing)
```

35 predefined TypeScript template functions map structured YAML to `LayoutElement[]` on a 1920×1080 canvas. Both renderers consume the same IR.

### Side-by-Side

| Dimension | frontend-slides | talks |
|---|---|---|
| **Generation** | Claude writes raw HTML/CSS per slide | YAML → fixed template functions → IR → renderers |
| **Templates** | None — infinite composition | 35 fixed TypeScript layout functions |
| **IR** | None | `LayoutPresentation` JSON (ground truth for both targets) |
| **Output targets** | Single HTML file + optional Python script | Web renderer + PPTX exporter from same model |
| **Visual elements** | Anything CSS can produce | 7 element types: text, image, shape, group, code, table, list |
| **Customization** | Unlimited per slide | Constrained to template parameters |
| **PPTX approach** | Bespoke script per presentation | Generic exporter for all presentations |
| **Reproducibility** | Low — each generation is unique | High — deterministic pipeline |
| **Testability** | Manual visual inspection | Unit + integration + E2E tests |
| **Dual-target consistency** | None — HTML and PPTX are independent | Guaranteed — same IR drives both |

## Theming Comparison

### frontend-slides: 12 Curated Style Presets

Each preset defines: vibe description, layout pattern, specific font pairings (from Fontshare/Google Fonts), full CSS custom property blocks, and signature visual elements unique to that style.

Presets: Bold Signal, Electric Studio, Creative Voltage, Dark Botanical, Notebook Tabs, Pastel Geometry, Split Pastel, Vintage Editorial, Neon Cyber, Terminal Green, Swiss Modern, Paper & Ink.

Explicitly bans "AI slop": no Inter/Roboto, no generic purple gradients, no `#6366f1` indigo, no gratuitous glassmorphism.

### talks: 16 ResolvedTheme Objects

Each theme is a `ResolvedTheme` with ~30 concrete color/font/spacing values consumed by both renderers. Themes define palette + typography but not layout patterns or signature elements.

The themes cover more ground (16 vs 12) but at lower fidelity per theme — they're color palettes rather than complete visual identities.

## The Fundamental Trade-off

```
Expressiveness ←————————————————————→ Structure

frontend-slides                          talks
(freeform HTML,                         (layout model IR,
 anything CSS can do,                    35 templates,
 unique per generation,                  deterministic,
 no shared IR,                           dual-target rendering,
 manual PPTX scripts)                    testable, reproducible)
```

### What frontend-slides gains from freeform generation

- **Arbitrary visual elements**: seals, tags, brush dividers, ink washes — anything expressible in CSS
- **Per-slide composition**: each slide freely mixes content types (bullets + stats + quotes + decorative elements)
- **Per-panel styling**: split layouts with different text colors, backgrounds, and component styles per panel
- **Theme-specific layout patterns**: the theme doesn't just change colors — it changes the entire spatial structure
- **Content-aware sizing**: elements sized and positioned relative to actual content, not fixed template slots

### What talks gains from the layout model

- **Dual-target rendering**: web and PPTX from the same source of truth, guaranteed consistency
- **PPTX animations**: OOXML entrance animations via post-processing (frontend-slides has none in PPTX)
- **Testability**: 173 unit/integration tests + E2E tests validate the pipeline
- **Deterministic output**: same YAML always produces the same slides
- **Instant iteration**: change YAML, see result immediately — no waiting for Claude to regenerate
- **Separation of concerns**: content (YAML) is fully decoupled from presentation (templates + themes)

## Specific Expressiveness Gaps

### 1. No per-panel text styling in split layouts

The `split-bg` decorator adds two background rectangles, but templates like `comparison` use the same `theme.text` and `theme.heading` colors for both panels. The original HTML uses `.panel-right h2 { color: var(--text-on-dark); }` to restyle text on the dark panel.

**Impact**: Split layouts with a dark panel are impossible — text would be invisible.

### 2. One template type per slide

Each slide maps to exactly one template function. The original freely mixes content types:
- Slide 2: bullet list (left) + large stats (right)
- Slide 11: bullet list (left) + blockquote + commentary (right)
- Slide 15: bullet list (left) + large stat number + note (right)
- Slide 20: title + paragraph + 3-character stats + seal stamp

Our `comparison` template can approximate some of these by putting everything into list items, but the visual hierarchy is lost — stats look like bullets, quotes look like bullets.

### 3. No decorative elements vocabulary

The original uses visual elements with no equivalent in our `LayoutElement` union:
- **Seal stamps**: rotated bordered squares with single characters
- **Dynasty tags**: colored label badges
- **Brush dividers**: vertical gradient lines
- **Ink dividers**: horizontal gradient-to-transparent lines
- **Era badges**: outlined pills with dot indicators

### 4. No content-aware card styling

The `comparison` template uses fixed green/red accent colors for left/right cards. The original varies these per slide: gold for 后周, red for 后晋's warning about 燕云十六州, neutral for most.

### 5. icon-grid too constrained

The `icon-grid` template shows icon + label per item. The original's kingdom grid shows name + dates + founder in a structured card. There's no way to express multi-line structured content per grid item.

## Implications

This analysis clarifies the architectural boundaries of the layout model approach. The expressiveness gap is not a bug — it's the cost of the structure that enables dual-target rendering, testability, and determinism.

Future directions could include:
- **Richer element types** (badge, divider, seal as first-class elements)
- **Per-panel theme overrides** in split layouts
- **Composite templates** that mix content types (e.g., bullets-and-stats, timeline-and-summary)
- **Freeform mode** where Claude generates layout model JSON directly instead of authoring YAML

But each addition increases complexity in both renderers and the PPTX exporter, which must faithfully reproduce every new element type.
